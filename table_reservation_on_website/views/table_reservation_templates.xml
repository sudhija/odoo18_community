<odoo>
<!-- Updated Template for Time and Slots -->
<template id="table_reservation" name="Table Reservation">
    <t t-call="website.layout">
        <div id="wrap" class="oe_structure oe_empty">
            <div class="container py-4">
                <form action="/restaurant/floors" method="post" enctype="multipart/form-data" class="o_mark_required" data-mark="*">
                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>

                    <!-- Header -->
                    <div class="text-center mb-4">
                        <h1 class="fw-bold">Table Reservation</h1>
                        <t t-if="opening_hour and closing_hour">
                            <h5 class="text-muted mt-2">
                                Opening Hours:
                                <t t-esc="opening_hour"/> - <t t-esc="closing_hour"/>
                            </h5>
                        </t>
                    </div>

                    <!-- Date Selection -->
                    <div class="row justify-content-center mb-4">
                        <div class="col-12 col-md-8 col-lg-6">
                            <div class="row align-items-center">
                                <label for="date" class="col-12 col-sm-3 col-form-label fw-bold">Date</label>
                                <div class="col-12 col-sm-9 mt-2 mt-sm-0">
                                    <input type="date" name="date" class="form-control" id="date" required="1"/>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Time Selection -->
                    <div class="row justify-content-center mb-4">
                        <div class="col-12 col-md-10">
                            <div class="row gy-3 gx-4 align-items-center">

                                <!-- Slots Label -->
                                <div class="col-12 col-md-2 text-md-end text-center fw-bold">
                                    Slots:
                                </div>

                                <!-- Start Time -->
                                <div class="col-12 col-md-4">
                                    <label for="start_time" class="form-label fw-bold">Start Time</label>
                                    <select id="start_time" name="start_time" class="form-control s_website_form_input" required="1">
                                        <option value="" disabled="disabled" selected="selected">Select Start Time</option>
                                        <t t-if="opening_minutes and closing_minutes">
                                            <t t-foreach="range(opening_minutes, closing_minutes + 1, 30)" t-as="minutes">
                                                <t t-set="hour" t-value="int(minutes/60)"/>
                                                <t t-set="minute" t-value="minutes % 60"/>
                                                <t t-set="hour12" t-value="(hour - 1) % 12 + 1"/>
                                                <t t-set="ampm" t-value="'AM' if hour &lt; 12 else 'PM'"/>
                                                <t t-set="time_label" t-value="str(hour12).zfill(2) + ':' + str(minute).zfill(2) + ' ' + ampm"/>
                                                <option t-att-value="time_label"><t t-esc="time_label"/></option>
                                            </t>
                                        </t>
                                    </select>
                                </div>

                                <!-- End Time -->
                                <div class="col-12 col-md-4">
                                    <label for="end_time" class="form-label fw-bold">End Time</label>
                                    <select id="end_time" name="end_time" class="form-control s_website_form_input" required="1">
                                        <option value="" disabled="disabled" selected="selected">Select End Time</option>
                                        <t t-if="opening_minutes and closing_minutes">
                                            <t t-foreach="range(opening_minutes + 30, closing_minutes + 1, 30)" t-as="minutes">
                                                <t t-set="hour" t-value="int(minutes/60)"/>
                                                <t t-set="minute" t-value="minutes % 60"/>
                                                <t t-set="hour12" t-value="(hour - 1) % 12 + 1"/>
                                                <t t-set="ampm" t-value="'AM' if hour &lt; 12 else 'PM'"/>
                                                <t t-set="time_label" t-value="str(hour12).zfill(2) + ':' + str(minute).zfill(2) + ' ' + ampm"/>
                                                <option t-att-value="time_label"><t t-esc="time_label"/></option>
                                            </t>
                                        </t>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <div class="text-center mt-4">
                        <button type="submit" class="btn btn-primary px-4">Submit</button>
                    </div>

                    <!-- Modals for Alerts -->
                    <t t-set="modals">
                        <!-- Invalid Date Modal -->
                        <div class="modal" tabindex="-1" id="alert_modal">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">Invalid Date</h5>
                                    </div>
                                    <hr class="m-0"/>
                                    <div class="modal-body">
                                        <p>Please select a valid date.</p>
                                    </div>
                                    <hr class="m-0"/>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary close_btn_alert_modal" data-bs-dismiss="modal">Close</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Invalid Time Modal -->
                        <div class="modal" tabindex="-1" id="time_alert_modal">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">Invalid Time</h5>
                                    </div>
                                    <hr class="m-0"/>
                                    <div class="modal-body">
                                        <p>Please select a valid booking start and end time.</p>
                                    </div>
                                    <hr class="m-0"/>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary close_btn_time_alert_modal" data-bs-dismiss="modal">Close</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Open Hours Modal -->
                        <div class="modal" tabindex="-1" id="open_hours_alert_modal">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">Invalid Time</h5>
                                    </div>
                                    <hr class="m-0"/>
                                    <div class="modal-body">
                                        <p>Select a time between the opening and closing hours.</p>
                                    </div>
                                    <hr class="m-0"/>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary close_btn_time_alert_modal" data-bs-dismiss="modal">Close</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </form>
            </div>
        </div>
    </t>
</template>




<!--   Template for floors (Responsive + No Logic Change)   -->
<template id="restaurant_floors" name="Admission Submit">
    <t t-call="website.layout">
        <div id="wrap" class="oe_structure oe_empty">
            <div class="container swa_container py-4">
                <form action="/booking/confirm" method="POST" enctype="multipart/form-data" class="oe_import">

                    <!-- Floor Selection -->
                    <div class="row align-items-center mb-4">
                        <div class="col-12 col-md-3 mb-2 mb-md-0">
                            <span class="fw-bold">Select Your Floor</span>
                        </div>
                        <div class="col-12 col-md-4">
                            <select name="floors" id="floors_rest" class="form-control">
                                <option value="0">Select a Floor</option>
                                <t t-foreach="floors" t-as="floor">
                                    <option t-att-value="floor.id">
                                        <t t-esc="floor.name"/>
                                    </option>
                                </t>
                            </select>
                        </div>
                    </div>

                    <!-- Already booked alert -->
                    <t t-if="already_booked">
                        <div class="alert alert-danger text-center fs-5 py-3">
                            <strong>Already Booked!</strong> Please choose another slot.
                        </div>
                    </t>

                    <t t-else="">
                        <div id="info" style="display:block;">
                            <div class="row g-3" id="tableContainer">

                                <!-- Table Layout -->
                                <div class="col-12 col-lg-6" id="table_container_row"></div>

                                <!-- Booking Info Card -->
                                <div class="col-12 col-lg-6">
                                    <div class="card" style="background-color:#c8e0e0;border:0;">
                                        <div class="card-body">
                                            <h5 class="card-title fs-3 mb-3">Booking Info</h5>
                                            <table class="table table-borderless mb-3">
                                                <tr>
                                                    <td>Date:</td>
                                                    <td class="text-end" id="date_booking">
                                                        <t t-esc="date"/>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>Start Time:</td>
                                                    <td class="text-end" id="booking_start">
                                                        <t t-esc="start_time"/>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>End Time:</td>
                                                    <td class="text-end" id="booking_end">
                                                        <t t-esc="end_time"/>
                                                    </td>
                                                </tr>
                                                <t t-if="payment == 'True'">
                                                    <tr>
                                                        <td><b>Booking Amount For <span id="count_table">0</span> Tables</b></td>
                                                        <td class="text-end">
                                                            <span id="total_amount"/>
                                                        </td>
                                                    </tr>
                                                </t>
                                            </table>

                                            <!-- Hidden Fields -->
                                            <span hidden="hidden">
                                                <input name="date" id="date_id" class="form-control border-0 p-0" type="text" t-att-value="date"/>
                                                <input name="start_time" id="start_id" class="form-control border-0 p-0" type="text" t-att-value="start_time"/>
                                                <input name="end_time" id="end_id" class="form-control border-0 p-0" type="text" t-att-value="end_time"/>
                                                <input name="tables" id="tables_input" class="form-control border-0 p-0" type="text"/>
                                            </span>

                                            <!-- Confirm Button (unchanged, stays disabled until enabled via JS) -->
                                            <div class="d-grid">
                                                <button type="submit" id="booking_confirm_btn" disabled="disabled" class="btn btn-primary submit_button">
                                                    Booking Confirm
                                                </button>
                                            </div>
                                        </div>

                                        <t t-if="payment">
                                            <div class="p-2 text-danger small text-center">
                                                <t t-esc="refund"/>
                                            </div>
                                        </t>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </form>
            </div>
        </div>
    </t>
</template>



<template id="reservation_success_page" name="Reservation Success Page">
    <t t-call="website.layout">
        <div class="container mt-5 mb-5">
            <h2 class="text-success mb-3">Your Reservation is Confirmed!</h2>
            <p>Dear <strong><t t-esc="request.env.user.name"/></strong>,</p>
            <p>
                Your reservation has been successfully confirmed for
                <strong><t t-esc="reservation.date"/></strong> from
                <strong><t t-esc="reservation.starting_at"/></strong> to
                <strong><t t-esc="reservation.ending_at"/></strong>.
            </p>
            <p>
                Reserved tables:
                <t t-foreach="tables" t-as="table">
                    <span class="badge bg-primary m-1"><t t-esc="table.display_name"/></span>
                </t>

            </p>
            <p class="mt-3">Thank you for choosing <strong><t t-esc="company.name"/></strong>!</p>
            <a href="/" class="btn btn-primary mt-4">Go to Home</a>
        </div>
    </t>
</template>

<template id="reservation_review_page" name="Reservation Review">
    <t t-call="website.layout">
        <div class="container">
            <h2>Review Your Booking</h2>
            <p>Date: <t t-esc="date"/></p>
            <p>Start Time: <t t-esc="start_time"/></p>
            <p>End Time: <t t-esc="end_time"/></p>
            <p>Selected Tables: <t t-esc="tables"/></p>
            <p>Floor: <t t-esc="floors"/></p>

            <form action="/booking/confirm" method="POST">
    <input type="hidden" name="date" t-att-value="date"/>
    <input type="hidden" name="start_time" t-att-value="start_time"/>
    <input type="hidden" name="end_time" t-att-value="end_time"/>
    <input type="hidden" name="tables" t-att-value="tables"/>
    <input type="hidden" name="floors" t-att-value="floors"/>

    <p><b>Date:</b> <t t-esc="date"/></p>
    <p><b>Start Time:</b> <t t-esc="start_time"/></p>
    <p><b>End Time:</b> <t t-esc="end_time"/></p>
    <p><b>Selected Tables:</b> <t t-esc="tables"/></p>
    <p><b>Floor:</b> <t t-esc="floors"/></p>

    <button type="submit" class="btn btn-primary">Confirm Booking</button>
</form>

        </div>
    </t>
</template>



</odoo>
